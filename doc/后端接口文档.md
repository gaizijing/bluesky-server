# ä½ç©ºæ°”è±¡é£è¡Œä¿éšœæœåŠ¡ç³»ç»Ÿ - åç«¯æ¥å£æ–‡æ¡£

> **æŠ€æœ¯æ ˆ**: Spring Boot 3 + PostgreSQL + MyBatis-Plus  
> **åè®®**: RESTful API  
> **æ•°æ®æ ¼å¼**: JSON  
> **ç¼–ç **: UTF-8

---

## ğŸ“‹ ç›®å½•

- [1. é€šç”¨è§„èŒƒ](#1-é€šç”¨è§„èŒƒ)
- [2. è®¤è¯æˆæƒæ¨¡å—](#2-è®¤è¯æˆæƒæ¨¡å—)
- [3. é‡ç‚¹å…³æ³¨åŒºåŸŸç®¡ç†æ¨¡å—](#3-é‡ç‚¹å…³æ³¨åŒºåŸŸç®¡ç†æ¨¡å—)
- [4. æ°”è±¡æ•°æ®æ¨¡å—](#4-æ°”è±¡æ•°æ®æ¨¡å—)
- [5. é€‚é£åˆ†ææ¨¡å—](#5-é€‚é£åˆ†ææ¨¡å—)
- [6. é£é™©é¢„è­¦æ¨¡å—](#6-é£é™©é¢„è­¦æ¨¡å—)
- [7. é£è¡Œä»»åŠ¡æ¨¡å—](#7-é£è¡Œä»»åŠ¡æ¨¡å—)
- [8. æ ¸å¿ƒæ°”è±¡è¦ç´ æ¨¡å—](#8-æ ¸å¿ƒæ°”è±¡è¦ç´ æ¨¡å—)
- [9. å‚ç›´å‰–é¢æ•°æ®æ¨¡å—](#9-å‚ç›´å‰–é¢æ•°æ®æ¨¡å—)
- [10. æ•°æ®åº“è®¾è®¡å»ºè®®](#10-æ•°æ®åº“è®¾è®¡å»ºè®®)

---

## 1. é€šç”¨è§„èŒƒ

### 1.1 ç»Ÿä¸€å“åº”æ ¼å¼

æ‰€æœ‰æ¥å£ç»Ÿä¸€ä½¿ç”¨ä»¥ä¸‹å“åº”æ ¼å¼:

```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

**å­—æ®µè¯´æ˜**:
- `code`: çŠ¶æ€ç ,200è¡¨ç¤ºæˆåŠŸ,å…¶ä»–è¡¨ç¤ºå¤±è´¥
- `message`: å“åº”æ¶ˆæ¯,æˆåŠŸæ—¶ä¸º"success",å¤±è´¥æ—¶ä¸ºå…·ä½“é”™è¯¯ä¿¡æ¯
- `data`: å“åº”æ•°æ®,å…·ä½“ç»“æ„æ ¹æ®æ¥å£è€Œå®š

### 1.2 HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜ |
|-------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒ,éœ€è¦ç™»å½• |
| 403 | æ— æƒé™è®¿é—® |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

### 1.3 æ—¶é—´æ ¼å¼

- **æ—¥æœŸæ—¶é—´**: `yyyy-MM-dd HH:mm:ss` (å¦‚: `2025-11-03 10:00:00`)
- **æ—¥æœŸ**: `yyyy-MM-dd` (å¦‚: `2025-11-03`)
- **æ—¶é—´**: `HH:mm:ss` (å¦‚: `10:00:00`)
- **æ—¶é—´æˆ³**: Unixæ—¶é—´æˆ³(æ¯«ç§’)

---

## 2. è®¤è¯æˆæƒæ¨¡å—

### 2.1 ç”¨æˆ·ç™»å½•

**æ¥å£åœ°å€**: `POST /api/auth/login`

**åŠŸèƒ½æè¿°**: ç”¨æˆ·ç™»å½•,è·å–è®¿é—®ä»¤ç‰Œ

**è¯·æ±‚å‚æ•°**:

```json
{
  "username": "admin",
  "password": "admin123"
}
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| username | String | æ˜¯ | ç”¨æˆ·å |
| password | String | æ˜¯ | å¯†ç  |

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "id": "user-1",
      "username": "admin",
      "name": "ç³»ç»Ÿç®¡ç†å‘˜",
      "role": "admin",
      "permissions": ["dashboard", "setting", "map"]
    }
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `token`: JWTè®¿é—®ä»¤ç‰Œ,åç»­è¯·æ±‚éœ€åœ¨Headerä¸­æºå¸¦: `Authorization: Bearer {token}`
- `userInfo.id`: ç”¨æˆ·å”¯ä¸€æ ‡è¯†
- `userInfo.username`: ç”¨æˆ·å
- `userInfo.name`: ç”¨æˆ·çœŸå®å§“å
- `userInfo.role`: ç”¨æˆ·è§’è‰²
- `userInfo.permissions`: ç”¨æˆ·æƒé™åˆ—è¡¨

---

### 2.2 ç”¨æˆ·ç™»å‡º

**æ¥å£åœ°å€**: `POST /api/auth/logout`

**åŠŸèƒ½æè¿°**: ç”¨æˆ·ç™»å‡º,æ¸…é™¤ä¼šè¯

**è¯·æ±‚å¤´**:
```
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "success": true
  }
}
```

---

### 2.3 è·å–ç”¨æˆ·ä¿¡æ¯

**æ¥å£åœ°å€**: `GET /api/auth/userInfo`

**åŠŸèƒ½æè¿°**: è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯

**è¯·æ±‚å¤´**:
```
Authorization: Bearer {token}
```

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "user-1",
    "username": "admin",
    "name": "ç³»ç»Ÿç®¡ç†å‘˜",
    "role": "admin",
    "permissions": ["dashboard", "setting", "map"],
    "lastLoginTime": "2025-11-03T10:00:00.000Z"
  }
}
```

---

## 3. é‡ç‚¹å…³æ³¨åŒºåŸŸç®¡ç†æ¨¡å—

### 3.1 è·å–é‡ç‚¹å…³æ³¨åŒºåŸŸåˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/monitoring-points`

**åŠŸèƒ½æè¿°**: è·å–æ‰€æœ‰é‡ç‚¹å…³æ³¨åŒºåŸŸåˆ—è¡¨

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": "point-1",
      "name": "é’å²›ä¸­å¿ƒèµ·é™åª",
      "type": "takeoff",
      "location": "å¸‚å—åŒº-äº”å››å¹¿åœºé™„è¿‘",
      "coordinates": [120.3835, 36.0625],
      "bbox": [[120.3735, 36.0525], [120.3935, 36.0725]],
      "status": "available",
      "warningReason": "",
      "lastUpdate": 1640995200000,
      "grids": ["BD_120.38_36.06", "BD_120.39_36.06"]
    }
  ]
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `id`: é‡ç‚¹å…³æ³¨åŒºåŸŸå”¯ä¸€æ ‡è¯†
- `name`: é‡ç‚¹å…³æ³¨åŒºåŸŸåç§°
- `type`: ç±»å‹,å¯é€‰å€¼: `takeoff`(èµ·é™ç‚¹)ã€`operation`(ä½œä¸šç‚¹)
- `location`: ä½ç½®æè¿°
- `coordinates`: ä¸­å¿ƒåæ ‡ [ç»åº¦, çº¬åº¦]
- `bbox`: è¾¹ç•Œæ¡† [[å·¦ä¸‹è§’ç»åº¦, å·¦ä¸‹è§’çº¬åº¦], [å³ä¸Šè§’ç»åº¦, å³ä¸Šè§’çº¬åº¦]]
- `status`: çŠ¶æ€,å¯é€‰å€¼: `available`(å¯ç”¨)ã€`warning`(è­¦å‘Š)ã€`unavailable`(ä¸å¯ç”¨)
- `warningReason`: è­¦å‘ŠåŸå› ,å½“statusä¸ºwarningæˆ–unavailableæ—¶è¯´æ˜åŸå› 
- `lastUpdate`: æœ€åæ›´æ–°æ—¶é—´(Unixæ—¶é—´æˆ³,æ¯«ç§’)
- `grids`: å…³è”çš„ç½‘æ ¼IDåˆ—è¡¨

---

### 3.2 è·å–å½“å‰é€‰ä¸­çš„é‡ç‚¹å…³æ³¨åŒºåŸŸ

**æ¥å£åœ°å€**: `GET /api/monitoring-points/selected`

**åŠŸèƒ½æè¿°**: è·å–å½“å‰ç”¨æˆ·é€‰ä¸­çš„é‡ç‚¹å…³æ³¨åŒºåŸŸ

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "point-1",
    "name": "é’å²›ä¸­å¿ƒèµ·é™åª",
    "type": "takeoff",
    "location": "å¸‚å—åŒº-äº”å››å¹¿åœºé™„è¿‘",
    "coordinates": [120.3835, 36.0625],
    "bbox": [[120.3735, 36.0525], [120.3935, 36.0725]],
    "status": "available",
    "warningReason": "",
    "lastUpdate": 1640995200000,
    "grids": ["BD_120.38_36.06", "BD_120.39_36.06"]
  }
}
```

---

### 3.3 æ›´æ–°é€‰ä¸­çš„é‡ç‚¹å…³æ³¨åŒºåŸŸ

**æ¥å£åœ°å€**: `POST /api/monitoring-points/selected`

**åŠŸèƒ½æè¿°**: æ›´æ–°å½“å‰ç”¨æˆ·é€‰ä¸­çš„é‡ç‚¹å…³æ³¨åŒºåŸŸ

**è¯·æ±‚å‚æ•°**:

```json
{
  "pointId": "point-1"
}
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pointId | String | æ˜¯ | é‡ç‚¹å…³æ³¨åŒºåŸŸID |

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "pointId": "point-1",
    "selectedTime": "2025-11-03T10:00:00.000Z",
    "status": "updated"
  }
}
```

---

### 3.4 æ·»åŠ æ–°çš„é‡ç‚¹å…³æ³¨åŒºåŸŸ

**æ¥å£åœ°å€**: `POST /api/monitoring-points`

**åŠŸèƒ½æè¿°**: æ·»åŠ æ–°çš„é‡ç‚¹å…³æ³¨åŒºåŸŸ

**è¯·æ±‚å‚æ•°**:

```json
{
  "name": "æ–°èµ·é™ç‚¹",
  "type": "takeoff",
  "location": "æŸåŒºåŸŸ-æŸåœ°ç‚¹",
  "coordinates": [120.40, 36.10],
  "bbox": [[120.39, 36.09], [120.41, 36.11]]
}
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| name | String | æ˜¯ | é‡ç‚¹å…³æ³¨åŒºåŸŸåç§° |
| type | String | æ˜¯ | ç±»å‹: takeoff/operation |
| location | String | æ˜¯ | ä½ç½®æè¿° |
| coordinates | Array | æ˜¯ | ä¸­å¿ƒåæ ‡ [ç»åº¦, çº¬åº¦] |
| bbox | Array | æ˜¯ | è¾¹ç•Œæ¡† [[å·¦ä¸‹ç»åº¦,å·¦ä¸‹çº¬åº¦],[å³ä¸Šç»åº¦,å³ä¸Šçº¬åº¦]] |

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "point-11",
    "name": "æ–°èµ·é™ç‚¹",
    "type": "takeoff",
    "location": "æŸåŒºåŸŸ-æŸåœ°ç‚¹",
    "coordinates": [120.40, 36.10],
    "bbox": [[120.39, 36.09], [120.41, 36.11]],
    "status": "available",
    "warningReason": "",
    "lastUpdate": 1640999000000,
    "grids": []
  }
}
```

---

## 4. æ°”è±¡æ•°æ®æ¨¡å—

### 4.1 è·å–é‡ç‚¹å…³æ³¨åŒºåŸŸå®æ—¶å¤©æ°”æ•°æ®

**æ¥å£åœ°å€**: `GET /api/weather/now/{pointId}`

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šé‡ç‚¹å…³æ³¨åŒºåŸŸçš„å®æ—¶æ°”è±¡æ•°æ®

**è·¯å¾„å‚æ•°**:
- `pointId`: é‡ç‚¹å…³æ³¨åŒºåŸŸID

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "obsTime": "2025-11-03T10:00:00+08:00",
    "temp": "25",
    "feelsLike": "24",
    "icon": "100",
    "text": "æ™´",
    "wind360": "45",
    "windDir": "ä¸œåŒ—é£",
    "windScale": "3",
    "windSpeed": "12",
    "humidity": "68",
    "precip": "0.0",
    "pressure": "1013",
    "vis": "10",
    "cloud": "25",
    "dew": "18",
    "windShearLevel": "medium",
    "stabilityIndex": "C"
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `obsTime`: è§‚æµ‹æ—¶é—´
- `temp`: æ¸©åº¦(â„ƒ)
- `feelsLike`: ä½“æ„Ÿæ¸©åº¦(â„ƒ)
- `icon`: å¤©æ°”å›¾æ ‡ä»£ç 
- `text`: å¤©æ°”çŠ¶å†µæ–‡å­—æè¿°
- `wind360`: é£å‘360åº¦æ–¹ä½
- `windDir`: é£å‘æ–‡å­—æè¿°
- `windScale`: é£åŠ›ç­‰çº§
- `windSpeed`: é£é€Ÿ(km/h)
- `humidity`: ç›¸å¯¹æ¹¿åº¦(%)
- `precip`: é™æ°´é‡(mm)
- `pressure`: å¤§æ°”å‹å¼º(hPa)
- `vis`: èƒ½è§åº¦(km)
- `cloud`: äº‘é‡(%)
- `dew`: éœ²ç‚¹æ¸©åº¦(â„ƒ)
- `windShearLevel`: é£åˆ‡å˜ç­‰çº§,å¯é€‰å€¼: `low`(ä½)ã€`medium`(ä¸­)ã€`high`(é«˜)
- `stabilityIndex`: ç¨³å®šåº¦æŒ‡æ•°,å¯é€‰å€¼: `S`(æä¸ç¨³å®š)ã€`A`(ä¸ç¨³å®š)ã€`B`(è¾ƒç¨³å®š)ã€`C`(ç¨³å®š)

---

### 4.2 è·å–é£å‘è¶‹åŠ¿æ•°æ®

**æ¥å£åœ°å€**: `GET /api/weather/wind-trend/{pointId}`

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šé‡ç‚¹å…³æ³¨åŒºåŸŸçš„é£å‘è¶‹åŠ¿æ•°æ®

**è·¯å¾„å‚æ•°**:
- `pointId`: é‡ç‚¹å…³æ³¨åŒºåŸŸID

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "time": "09:00",
      "windSpeed": 3.2,
      "windDir": 45,
      "upper": 4.0,
      "lower": 2.4,
      "deviation": 0.8
    },
    {
      "time": "09:30",
      "windSpeed": 4.1,
      "windDir": 52,
      "upper": 4.9,
      "lower": 3.3,
      "deviation": 0.8
    }
  ]
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `time`: æ—¶é—´ç‚¹(HH:mmæ ¼å¼)
- `windSpeed`: é£é€Ÿ(m/s)
- `windDir`: é£å‘(åº¦,0-360)
- `upper`: é£é€Ÿä¸Šé™(m/s)
- `lower`: é£é€Ÿä¸‹é™(m/s)
- `deviation`: åå·®å€¼(m/s)

---

### 4.3 è·å–é£åœºæ•°æ®

**æ¥å£åœ°å€**: `GET /api/weather/wind-field`

**åŠŸèƒ½æè¿°**: è·å–3Dé£åœºæ•°æ®,ç”¨äºCesiumå¯è§†åŒ–

**æŸ¥è¯¢å‚æ•°**:
- `time`: æ—¶é—´(å¯é€‰,é»˜è®¤å½“å‰æ—¶é—´)

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "updateTime": "2025-11-03T10:00:00.000Z",
    "layers": [
      {
        "height": 100,
        "particles": [
          {
            "lng": 120.38,
            "lat": 36.06,
            "u": 3.2,
            "v": 2.1,
            "speed": 3.8,
            "direction": 45
          }
        ]
      }
    ]
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `updateTime`: æ•°æ®æ›´æ–°æ—¶é—´
- `layers`: ä¸åŒé«˜åº¦å±‚çš„é£åœºæ•°æ®
- `height`: é«˜åº¦(ç±³)
- `particles`: é£åœºç²’å­æ•°æ®
- `lng`: ç»åº¦
- `lat`: çº¬åº¦
- `u`: ä¸œè¥¿æ–¹å‘é£é€Ÿåˆ†é‡(m/s)
- `v`: å—åŒ—æ–¹å‘é£é€Ÿåˆ†é‡(m/s)
- `speed`: é£é€Ÿ(m/s)
- `direction`: é£å‘(åº¦)

---

## 5. é€‚é£åˆ†ææ¨¡å—

### 5.1 è·å–é€‚é£åˆ†ææ•°æ®

**æ¥å£åœ°å€**: `POST /api/weather/suitability`

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šé‡ç‚¹å…³æ³¨åŒºåŸŸæœªæ¥æ—¶æ®µçš„é€‚é£åˆ†ææ•°æ®

**è¯·æ±‚å‚æ•°**:

```json
{
  "pointId": "point-1",
  "timeInterval": 10,
  "totalHours": 3,
  "factors": ["ç»¼åˆ", "é£", "é£åˆ‡å˜", "é¢ ç°¸æŒ‡æ•°", "æ¹æµ", "é™æ°´", "èƒ½è§åº¦"]
}
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pointId | String | æ˜¯ | é‡ç‚¹å…³æ³¨åŒºåŸŸID |
| timeInterval | Integer | æ˜¯ | æ—¶é—´é—´éš”(åˆ†é’Ÿ),é»˜è®¤10åˆ†é’Ÿ |
| totalHours | Integer | æ˜¯ | é¢„æµ‹æ€»æ—¶é•¿(å°æ—¶),é»˜è®¤3å°æ—¶ |
| factors | Array | å¦ | éœ€è¦è¿”å›çš„æ°”è±¡å› ç´ åˆ—è¡¨,ä¸ä¼ åˆ™è¿”å›å…¨éƒ¨ |

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "timeInterval": 10,
    "totalHours": 3,
    "suitabilityList": [
      {
        "factor": "ç»¼åˆ",
        "detail": [
          {
            "timePoint": "10:00",
            "statusData": true,
            "valueData": ""
          },
          {
            "timePoint": "10:10",
            "statusData": false,
            "valueData": ""
          }
        ]
      },
      {
        "factor": "é£",
        "detail": [
          {
            "timePoint": "2025-11-17 10:00",
            "statusData": true,
            "valueData": ""
          },
          {
            "timePoint": "2025-11-17 10:10",
            "statusData": false,
            "valueData": "9m/s"
          }
        ]
      }
    ]
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `timeInterval`: æ—¶é—´é—´éš”(åˆ†é’Ÿ)
- `totalHours`: é¢„æµ‹æ€»æ—¶é•¿(å°æ—¶)
- `suitabilityList`: é€‚é£åˆ†æåˆ—è¡¨
- `factor`: æ°”è±¡å› ç´ åç§°
- `detail`: è¯¦ç»†æ•°æ®åˆ—è¡¨
- `timePoint`: æ—¶é—´ç‚¹(ç»¼åˆå› ç´ åªæ˜¾ç¤ºæ—¶é—´,å…¶ä»–å› ç´ æ˜¾ç¤ºå®Œæ•´æ—¥æœŸæ—¶é—´)
- `statusData`: é€‚é£çŠ¶æ€,trueè¡¨ç¤ºé€‚é£,falseè¡¨ç¤ºä¸é€‚é£
- `valueData`: å¼‚å¸¸å€¼,å½“ä¸é€‚é£æ—¶æ˜¾ç¤ºå…·ä½“æ•°å€¼,é€‚é£æ—¶ä¸ºç©ºå­—ç¬¦ä¸²

**é€‚é£åˆ¤å®šè§„åˆ™**:
- é£é€Ÿ > 8m/s åˆ¤å®šä¸ºä¸é€‚é£
- é£åˆ‡å˜ > 6m/s åˆ¤å®šä¸ºä¸é€‚é£
- é¢ ç°¸æŒ‡æ•°ä¸º"ä¸­"æˆ–"é«˜"åˆ¤å®šä¸ºä¸é€‚é£
- ç»¼åˆåˆ¤å®š:ä»»ä¸€å•é¡¹ä¸é€‚é£åˆ™ç»¼åˆçŠ¶æ€ä¸ºä¸é€‚é£

---

### 5.2 è·å–æœªæ¥é£åŠ¿çƒ­åŠ›å›¾æ•°æ®

**æ¥å£åœ°å€**: `POST /api/weather/forecast/heatmap`

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šé‡ç‚¹å…³æ³¨åŒºåŸŸä¸åŒé«˜åº¦çš„æ°”è±¡è¦ç´ å±é™©æŒ‡æ•°æ•°æ®

**è¯·æ±‚å‚æ•°**:

```json
{
  "pointId": "point-1",
  "element": "windSpeed",
  "timeRange": "2025-11-03 08:00:00,2025-11-03 12:00:00"
}
```

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pointId | String | æ˜¯ | é‡ç‚¹å…³æ³¨åŒºåŸŸID |
| element | String | æ˜¯ | æ°”è±¡è¦ç´ ç±»å‹: windSpeed/temperature/windShear/turbulence |
| timeRange | String | æ˜¯ | æ—¶é—´èŒƒå›´,æ ¼å¼: "å¼€å§‹æ—¶é—´,ç»“æŸæ—¶é—´" |

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "times": ["08:00", "08:30", "09:00", "09:30", "10:00", "10:30", "11:00"],
    "heights": [0, 50, 100, 150, 200, 250, 300],
    "data": [
      [93, 91, 90, 93, 97, 94, 79],
      [87, 86, 87, 88, 85, 83, 77],
      [78, 74, 72, 76, 71, 76, 69],
      [61, 66, 66, 67, 63, 63, 59],
      [52, 50, 51, 59, 55, 55, 50],
      [42, 44, 49, 42, 47, 48, 42],
      [38, 43, 33, 34, 32, 33, 27],
      [27, 22, 29, 27, 23, 23, 17]
    ]
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `times`: æ—¶é—´æ ‡ç­¾æ•°ç»„(HH:mmæ ¼å¼)
- `heights`: é«˜åº¦æ•°ç»„(ç±³)
- `data`: äºŒç»´æ•°ç»„,è¡Œ=é«˜åº¦å±‚,åˆ—=æ—¶é—´ç‚¹,å€¼=å±é™©æŒ‡æ•°(0-100)
  - 0-59: å·®(ä¸é€‚é£)
  - 60-79: è‰¯(è°¨æ…é£è¡Œ)
  - 80-100: ä¼˜(é€‚é£)

---

## 6. é£é™©é¢„è­¦æ¨¡å—

### 6.1 è·å–é£é™©é¢„è­¦æ•°æ®

**æ¥å£åœ°å€**: `GET /api/weather/risk/report`

**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šé‡ç‚¹å…³æ³¨åŒºåŸŸå’Œæ—¶é—´èŒƒå›´å†…çš„é£é™©é¢„è­¦ä¿¡æ¯

**æŸ¥è¯¢å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pointId | String | æ˜¯ | é‡ç‚¹å…³æ³¨åŒºåŸŸID |
| timeRange | String | æ˜¯ | æ—¶é—´èŒƒå›´,æ ¼å¼: "2025-11-03 00:00:00,2025-11-03 23:59:59" |

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "updateTime": "2025-11-03 10:40:00",
    "warnings": [
      {
        "id": "RW20251103001",
        "level": "danger",
        "type": "å¼ºé£",
        "area": "Aæœºåœºå‘¨è¾¹10km",
        "startTime": "10:05:00",
        "endTime": "11:30:00",
        "detail": "å½“å‰é£é€Ÿ14.8m/s,é¢„è®¡10:30åå¢è‡³18m/s,è¶…è¿‡å¤šæ•°æœºå‹é™åˆ¶",
        "suggestion": "æš‚åœè¯¥åŒºåŸŸæ‰€æœ‰é£è¡Œä»»åŠ¡,å·²èµ·é£çš„ç«‹å³è¿”èˆª",
        "handleStatus": "unhandled"
      }
    ]
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `updateTime`: æ•°æ®æ›´æ–°æ—¶é—´
- `warnings`: é¢„è­¦åˆ—è¡¨
- `id`: é¢„è­¦ID,æ ¼å¼: RW+æ—¥æœŸ+åºå·
- `level`: é¢„è­¦ç­‰çº§,å¯é€‰å€¼: `danger`(å±é™©)ã€`warning`(è­¦å‘Š)ã€`info`(ä¸€èˆ¬)
- `type`: é¢„è­¦ç±»å‹,å¦‚: å¼ºé£ã€ä½èƒ½è§åº¦ã€æ¸©åº¦éª¤é™ã€æ¹æµã€æ¹¿åº¦è¶…æ ‡ç­‰
- `area`: å½±å“åŒºåŸŸ
- `startTime`: é¢„è­¦å¼€å§‹æ—¶é—´(HH:mm:ss)
- `endTime`: é¢„è­¦ç»“æŸæ—¶é—´(HH:mm:ss)
- `detail`: è¯¦ç»†æè¿°
- `suggestion`: å»ºè®®æªæ–½
- `handleStatus`: å¤„ç†çŠ¶æ€,å¯é€‰å€¼: `unhandled`(æœªå¤„ç†)ã€`handled`(å·²å¤„ç†)

---

## 7. é£è¡Œä»»åŠ¡æ¨¡å—

### 7.1 è·å–é£è¡Œä»»åŠ¡åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/flight/tasks`

**åŠŸèƒ½æè¿°**: è·å–é£è¡Œä»»åŠ¡åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**:
- `status`: ä»»åŠ¡çŠ¶æ€(å¯é€‰),å¯é€‰å€¼: ongoing/waiting/completed
- `date`: æ—¥æœŸ(å¯é€‰),æ ¼å¼: yyyy-MM-dd

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "updateTime": "2025-11-03 10:30:00",
    "tasks": [
      {
        "taskId": "FT20251103001",
        "type": "æ•‘æ´",
        "typeColor": "#ef4444",
        "aircraftType": "è´å°”407",
        "takeoff": "Aæœºåœº",
        "landing": "å±±åŒºæ•‘æ´ç‚¹",
        "planHeight": 600,
        "status": "ongoing",
        "currentPos": "åŒ—çº¬30.12Â°,ä¸œç»120.56Â°",
        "meteorologyAdapt": "é€‚é…",
        "adaptReason": "å½“å‰äº‘åº•é«˜åº¦800m>è®¡åˆ’é«˜åº¦600m",
        "startTime": "09:30:00",
        "endTime": "11:00:00"
      }
    ]
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `updateTime`: æ•°æ®æ›´æ–°æ—¶é—´
- `tasks`: ä»»åŠ¡åˆ—è¡¨
- `taskId`: ä»»åŠ¡ID
- `type`: ä»»åŠ¡ç±»å‹,å¯é€‰å€¼: æ•‘æ´ã€ç‰©æµã€å·¡æ£€ã€è®­ç»ƒ
- `typeColor`: ç±»å‹é¢œè‰²(ç”¨äºå‰ç«¯æ˜¾ç¤º)
- `aircraftType`: é£è¡Œå™¨å‹å·
- `takeoff`: èµ·é£ç‚¹
- `landing`: é™è½ç‚¹
- `planHeight`: è®¡åˆ’é£è¡Œé«˜åº¦(ç±³)
- `status`: ä»»åŠ¡çŠ¶æ€,å¯é€‰å€¼: `ongoing`(è¿›è¡Œä¸­)ã€`waiting`(ç­‰å¾…ä¸­)ã€`completed`(å·²å®Œæˆ)
- `currentPos`: å½“å‰ä½ç½®(ä»…è¿›è¡Œä¸­ä»»åŠ¡æœ‰å€¼)
- `meteorologyAdapt`: æ°”è±¡é€‚é…çŠ¶æ€,å¯é€‰å€¼: `é€‚é…`ã€`ä¸é€‚é…`
- `adaptReason`: é€‚é…åŸå› è¯´æ˜
- `startTime`: å¼€å§‹æ—¶é—´(HH:mm:ss)
- `endTime`: ç»“æŸæ—¶é—´(HH:mm:ss)

---

### 7.2 è·å–é£è¡Œå™¨é€‚é…æ•°æ®

**æ¥å£åœ°å€**: `GET /api/flight/aircraft-adapt`

**åŠŸèƒ½æè¿°**: è·å–é£è¡Œå™¨ä¸æ°”è±¡æ¡ä»¶çš„é€‚é…åˆ†ææ•°æ®

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "updateTime": "2025-11-03 10:30:00",
    "aircrafts": [
      {
        "model": "è´å°”407",
        "category": "ç›´å‡æœº",
        "maxWindSpeed": 15,
        "maxWindShear": 8,
        "minVisibility": 2,
        "maxPrecipitation": 5,
        "temperatureRange": [-10, 40],
        "maxAltitude": 3000,
        "currentAdapt": true,
        "adaptReason": "æ‰€æœ‰æ°”è±¡å‚æ•°å‡åœ¨å®‰å…¨èŒƒå›´å†…"
      }
    ]
  }
}
```

---

## 8. æ ¸å¿ƒæ°”è±¡è¦ç´ æ¨¡å—

### 8.1 è·å–æ ¸å¿ƒæ°”è±¡è¦ç´ æ•°æ®

**æ¥å£åœ°å€**: `GET /api/meteorology/core-indicators`

**åŠŸèƒ½æè¿°**: è·å–æ ¸å¿ƒæ°”è±¡è¦ç´ çš„å®æ—¶ç›‘æµ‹æ•°æ®

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "updateTime": "2025-11-03 10:00:00",
    "indicators": [
      {
        "id": "temp",
        "name": "æ°”æ¸©",
        "value": 25.6,
        "unit": "â„ƒ",
        "precision": "Â±0.2â„ƒ",
        "status": "normal",
        "threshold": {
          "warning": 30,
          "danger": 35
        }
      },
      {
        "id": "humidity",
        "name": "æ¹¿åº¦",
        "value": 68,
        "unit": "%RH",
        "precision": "Â±3%",
        "status": "normal",
        "threshold": {
          "warning": 85,
          "danger": 95
        }
      },
      {
        "id": "windSpeed",
        "name": "é£é€Ÿ",
        "value": 14.8,
        "unit": "m/s",
        "precision": "Â±0.1m/s",
        "status": "warning",
        "threshold": {
          "warning": 15,
          "danger": 20
        }
      }
    ]
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `updateTime`: æ•°æ®æ›´æ–°æ—¶é—´
- `indicators`: æ°”è±¡è¦ç´ åˆ—è¡¨
- `id`: è¦ç´ æ ‡è¯†ç¬¦
- `name`: è¦ç´ åç§°
- `value`: å½“å‰å€¼
- `unit`: å•ä½
- `precision`: ç²¾åº¦è¯´æ˜
- `status`: çŠ¶æ€,å¯é€‰å€¼: `normal`(æ­£å¸¸)ã€`warning`(è­¦å‘Š)ã€`danger`(å±é™©)
- `threshold`: é˜ˆå€¼é…ç½®
  - `warning`: è­¦å‘Šé˜ˆå€¼
  - `danger`: å±é™©é˜ˆå€¼

---

### 8.2 è·å–å¾®å°ºåº¦å¤©æ°”æ•°æ®

**æ¥å£åœ°å€**: `GET /api/meteorology/microscale-weather`

**åŠŸèƒ½æè¿°**: è·å–å¾®å°ºåº¦å¤©æ°”æ•°æ®(ç”¨äºç²¾ç»†åŒ–æ°”è±¡åˆ†æ)

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "updateTime": "2025-11-03 10:00:00",
    "gridData": [
      {
        "gridId": "BD_120.38_36.06",
        "center": [120.38, 36.06],
        "temperature": 25.3,
        "humidity": 65,
        "windSpeed": 5.2,
        "windDirection": 45,
        "pressure": 1013.2
      }
    ]
  }
}
```

---

## 9. å‚ç›´å‰–é¢æ•°æ®æ¨¡å—

### 9.1 è·å–å‚ç›´å‰–é¢æ•°æ®

**æ¥å£åœ°å€**: `GET /api/meteorology/vertical-profile`

**åŠŸèƒ½æè¿°**: è·å–ä¸åŒé«˜åº¦å±‚çš„æ°”è±¡è¦ç´ å‚ç›´åˆ†å¸ƒæ•°æ®

**æŸ¥è¯¢å‚æ•°**:
- `pointId`: é‡ç‚¹å…³æ³¨åŒºåŸŸID(å¿…å¡«)
- `timeType`: æ—¶é—´ç±»å‹(å¯é€‰),å¯é€‰å€¼: `current`(å½“å‰)ã€`1h_ago`(1å°æ—¶å‰)ã€`1h_forecast`(1å°æ—¶é¢„æŠ¥)

**å“åº”ç¤ºä¾‹**:

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "updateTime": "2025-11-03 10:35:22",
    "heightLayers": [
      {
        "height": 0,
        "windSpeed": 5.2,
        "temperature": 25.3,
        "humidity": 65,
        "visibility": 8.5
      },
      {
        "height": 100,
        "windSpeed": 6.8,
        "temperature": 24.8,
        "humidity": 62,
        "visibility": 8.2
      },
      {
        "height": 600,
        "windSpeed": 14.3,
        "temperature": 21.8,
        "humidity": 53,
        "visibility": 6.8
      }
    ],
    "safetyThresholds": {
      "windSpeed": 12,
      "temperature": [-10, 35],
      "humidity": 90,
      "visibility": 1.5
    },
    "currentTask": {
      "taskId": "FT20251103001",
      "requiredHeightRange": [200, 500],
      "taskType": "æ•‘æ´"
    }
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `updateTime`: æ•°æ®æ›´æ–°æ—¶é—´
- `heightLayers`: é«˜åº¦å±‚æ•°æ®(0-1000ç±³,æ¯100ç±³ä¸€å±‚)
- `height`: é«˜åº¦(ç±³)
- `windSpeed`: é£é€Ÿ(m/s)
- `temperature`: æ¸©åº¦(â„ƒ)
- `humidity`: æ¹¿åº¦(%)
- `visibility`: èƒ½è§åº¦(km)
- `safetyThresholds`: å®‰å…¨é˜ˆå€¼
- `currentTask`: å½“å‰å…³è”ä»»åŠ¡ä¿¡æ¯

---

## 10. æ•°æ®åº“è®¾è®¡å»ºè®®

### 10.1 æ ¸å¿ƒè¡¨ç»“æ„

#### ç”¨æˆ·è¡¨ (users)

```sql
CREATE TABLE users (
    id VARCHAR(50) PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    name VARCHAR(100),
    role VARCHAR(20),
    permissions TEXT,
    last_login_time TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### é‡ç‚¹å…³æ³¨åŒºåŸŸè¡¨ (monitoring_points)

```sql
CREATE TABLE monitoring_points (
    id VARCHAR(50) PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    type VARCHAR(20) NOT NULL,
    location VARCHAR(200),
    longitude DECIMAL(10, 6),
    latitude DECIMAL(10, 6),
    bbox_min_lng DECIMAL(10, 6),
    bbox_min_lat DECIMAL(10, 6),
    bbox_max_lng DECIMAL(10, 6),
    bbox_max_lat DECIMAL(10, 6),
    status VARCHAR(20),
    warning_reason VARCHAR(500),
    last_update BIGINT,
    grids TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### é£é™©é¢„è­¦è¡¨ (risk_warnings)

```sql
CREATE TABLE risk_warnings (
    id VARCHAR(50) PRIMARY KEY,
    point_id VARCHAR(50),
    level VARCHAR(20) NOT NULL,
    type VARCHAR(50) NOT NULL,
    area VARCHAR(200),
    start_time TIME,
    end_time TIME,
    detail TEXT,
    suggestion TEXT,
    handle_status VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (point_id) REFERENCES monitoring_points(id)
);
```

#### é£è¡Œä»»åŠ¡è¡¨ (flight_tasks)

```sql
CREATE TABLE flight_tasks (
    task_id VARCHAR(50) PRIMARY KEY,
    type VARCHAR(20) NOT NULL,
    type_color VARCHAR(20),
    aircraft_type VARCHAR(100),
    takeoff VARCHAR(100),
    landing VARCHAR(100),
    plan_height INTEGER,
    status VARCHAR(20),
    current_pos VARCHAR(200),
    meteorology_adapt VARCHAR(20),
    adapt_reason TEXT,
    start_time TIME,
    end_time TIME,
    task_date DATE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### æ°”è±¡æ•°æ®è¡¨ (weather_data)

```sql
CREATE TABLE weather_data (
    id BIGSERIAL PRIMARY KEY,
    point_id VARCHAR(50),
    obs_time TIMESTAMP,
    temp DECIMAL(5, 2),
    feels_like DECIMAL(5, 2),
    humidity INTEGER,
    wind_speed DECIMAL(5, 2),
    wind_dir INTEGER,
    wind_scale VARCHAR(10),
    precip DECIMAL(5, 2),
    pressure DECIMAL(7, 2),
    visibility DECIMAL(5, 2),
    cloud INTEGER,
    wind_shear_level VARCHAR(20),
    stability_index VARCHAR(10),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (point_id) REFERENCES monitoring_points(id)
);
```

#### å‚ç›´å‰–é¢æ•°æ®è¡¨ (vertical_profile_data)

```sql
CREATE TABLE vertical_profile_data (
    id BIGSERIAL PRIMARY KEY,
    point_id VARCHAR(50),
    update_time TIMESTAMP,
    height INTEGER,
    wind_speed DECIMAL(5, 2),
    temperature DECIMAL(5, 2),
    humidity INTEGER,
    visibility DECIMAL(5, 2),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (point_id) REFERENCES monitoring_points(id)
);
```

### 10.2 ç´¢å¼•å»ºè®®

```sql
-- é‡ç‚¹å…³æ³¨åŒºåŸŸç´¢å¼•
CREATE INDEX idx_monitoring_points_status ON monitoring_points(status);
CREATE INDEX idx_monitoring_points_type ON monitoring_points(type);

-- é£é™©é¢„è­¦ç´¢å¼•
CREATE INDEX idx_risk_warnings_point_id ON risk_warnings(point_id);
CREATE INDEX idx_risk_warnings_level ON risk_warnings(level);
CREATE INDEX idx_risk_warnings_handle_status ON risk_warnings(handle_status);
CREATE INDEX idx_risk_warnings_created_at ON risk_warnings(created_at);

-- é£è¡Œä»»åŠ¡ç´¢å¼•
CREATE INDEX idx_flight_tasks_status ON flight_tasks(status);
CREATE INDEX idx_flight_tasks_task_date ON flight_tasks(task_date);
CREATE INDEX idx_flight_tasks_type ON flight_tasks(type);

-- æ°”è±¡æ•°æ®ç´¢å¼•
CREATE INDEX idx_weather_data_point_id ON weather_data(point_id);
CREATE INDEX idx_weather_data_obs_time ON weather_data(obs_time);

-- å‚ç›´å‰–é¢æ•°æ®ç´¢å¼•
CREATE INDEX idx_vertical_profile_point_id ON vertical_profile_data(point_id);
CREATE INDEX idx_vertical_profile_update_time ON vertical_profile_data(update_time);
CREATE INDEX idx_vertical_profile_height ON vertical_profile_data(height);
```

---

## é™„å½•

### A. é¢„è­¦ç­‰çº§é¢œè‰²è§„èŒƒ

| ç­‰çº§ | è‹±æ–‡æ ‡è¯† | é¢œè‰²ä»£ç  | è¯´æ˜ |
|------|----------|---------|------|
| å±é™© | danger | #ef4444 | ä¸¥é‡å½±å“é£è¡Œå®‰å…¨,éœ€ç«‹å³é‡‡å–æªæ–½ |
| è­¦å‘Š | warning | #f59e0b | å¯¹é£è¡Œæœ‰è¾ƒå¤§å½±å“,éœ€è°¨æ…å¯¹å¾… |
| ä¸€èˆ¬ | info | #3b82f6 | æœ‰ä¸€å®šå½±å“,ä½†å¯æ§,éœ€æ³¨æ„è§‚å¯Ÿ |

### B. ä»»åŠ¡ç±»å‹é¢œè‰²è§„èŒƒ

| ç±»å‹ | é¢œè‰²ä»£ç  |
|------|---------|
| æ•‘æ´ | #ef4444 |
| ç‰©æµ | #3b82f6 |
| å·¡æ£€ | #06b6d4 |
| è®­ç»ƒ | #f59e0b |

### C. æ°”è±¡è¦ç´ å•ä½å¯¹ç…§è¡¨

| è¦ç´  | å•ä½ | è¯´æ˜ |
|------|------|------|
| æ¸©åº¦ | â„ƒ | æ‘„æ°åº¦ |
| æ¹¿åº¦ | %RH | ç›¸å¯¹æ¹¿åº¦ç™¾åˆ†æ¯” |
| é£é€Ÿ | m/s | ç±³/ç§’ |
| èƒ½è§åº¦ | km | åƒç±³ |
| é™æ°´é‡ | mm | æ¯«ç±³ |
| æ°”å‹ | hPa | ç™¾å¸• |
| äº‘åº•é«˜åº¦ | m | ç±³ |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-03  
**ç»´æŠ¤è€…**: åç«¯å¼€å‘å›¢é˜Ÿ
